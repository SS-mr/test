SELECT 
    ISNULL(AAAAA.[file-path], BBBBB.[file-path]) AS [file-path],
    ISNULL(AAAAA.table_name, BBBBB.table_name) AS table_name,

    -- AAAAAのCRUD操作をまとめる
    CASE WHEN ISNULL(AAAAA.C, 0) = 1 THEN 'C' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.R, 0) = 1 THEN 'R' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.U, 0) = 1 THEN 'U' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.D, 0) = 1 THEN 'D' ELSE '' END AS A_CRUD,

    -- BBBBBのCRUD操作をまとめる
    CASE WHEN ISNULL(BBBBB.C, 0) = 1 THEN 'C' ELSE '' END +
    CASE WHEN ISNULL(BBBBB.R, 0) = 1 THEN 'R' ELSE '' END +
    CASE WHEN ISNULL(BBBBB.U, 0) = 1 THEN 'U' ELSE '' END +
    CASE WHEN ISNULL(BBBBB.D, 0) = 1 THEN 'D' ELSE '' END AS B_CRUD,

    -- 差分
    CASE WHEN ISNULL(AAAAA.C, 0) <> ISNULL(BBBBB.C, 0) THEN 'C' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.R, 0) <> ISNULL(BBBBB.R, 0) THEN 'R' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.U, 0) <> ISNULL(BBBBB.U, 0) THEN 'U' ELSE '' END +
    CASE WHEN ISNULL(AAAAA.D, 0) <> ISNULL(BBBBB.D, 0) THEN 'D' ELSE '' END AS Difference

FROM 
    UsageA AS AAAAA
FULL OUTER JOIN 
    UsageB AS BBBBB
ON 
    AAAAA.[file-path] = BBBBB.[file-path] AND AAAAA.table_name = BBBBB.table_name
WHERE 
    ISNULL(AAAAA.C, 0) <> ISNULL(BBBBB.C, 0)
    OR ISNULL(AAAAA.R, 0) <> ISNULL(BBBBB.R, 0)
    OR ISNULL(AAAAA.U, 0) <> ISNULL(BBBBB.U, 0)
    OR ISNULL(AAAAA.D, 0) <> ISNULL(BBBBB.D, 0);
